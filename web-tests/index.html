<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script type="module">
        import defaultExport from "../src/Lancelot.js";

        class Controller extends Lancelot.Component {
            constructor() {
                super();

            }
            Update() {
                const sprite = this.GetComponent("Sprite");
                const body = this.parent.body;

                body.velocity.y += 10;
                sprite.angle = body.angle;
            }
        }

        const game = new Lancelot.Game({
            width: 420,
            height: 480,
            background: "#242424",
            init: init
        });

        function init() {
            
            const scene = this.CreateScene("test");
            this.PlayScene("test");

            for (let i = 0; i < 1; ++i) {

                const myEntity = scene.CreateEntity();
                myEntity.groupList.add("m1");
                myEntity.position.y = -200 + i * 80;

                const body = new Lancelot.physics.Box({
                    width: 80,
                    height: 50,
                    friction: { y: 0.01, x: 0.01, angular: 0.01 },
                    mass: 5
                });
                body.AddBehavior("m0", "resolve", (other) => {
                    
                });

                myEntity.AddComponent(body);

                const sprite = new Lancelot.drawable.Rect({
                    fillStyle: "white",
                    width: body._width,
                    height: body._height,
                    angle: body.angle
                });
                myEntity.AddComponent(sprite, "Sprite");
                myEntity.AddComponent(new Controller());

            }

            for (let i = 0; i < 1; ++i) {

                    const myEntity = scene.CreateEntity();
                    myEntity.groupList.add("m0");
                    myEntity.position.y = 200;

                    const body = new Lancelot.physics.Box({
                        width: 300,
                        height: 50
                    });
                    body.angle = 0.5;

                    myEntity.AddComponent(body);

                    const sprite = new Lancelot.drawable.Rect({
                        fillStyle: "white",
                        width: body._width,
                        height: body._height,
                        angle: body.angle
                    });
                    myEntity.AddComponent(sprite, "Sprite");
                }
            
        }

        
    </script>
</body>
</html>